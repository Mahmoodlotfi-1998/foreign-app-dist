import{d as T,r as g,w as P,o as K,a as c,c as O,b as W,v as G,e as d,n as J,f as A,u as B,g as Q,F as X,h as Y,i as D,m as Z,j as x,k as L,l as _,p as I,T as M,t as H,B as ee,_ as ne,q as F,s as te,x as se,y as ae,z as oe,A as le,S as ue}from"./index-BvTff10S.js";import{_ as ie,a as re}from"./BasicInput.vue_vue_type_style_index_0_lang-CwhMoZEa.js";import{h as j}from"./moment-C5S46NFB.js";import{_ as R,F as de}from"./index-Dz1x8UI2.js";import{u as ce}from"./responsiveStore-BmdHSBo5.js";import"./index-BrCDGu-D.js";const pe="/assets/login-D7vvtwuK.svg";var V=T({name:"SingleOtpInput",props:{inputType:{type:String,validator:e=>["number","tel","letter-numeric","password"].includes(e),default:"tel"},inputmode:{type:String,default:"numeric"},value:{type:[String,Number]},separator:{type:String},focus:{type:Boolean},inputClasses:{type:[String,Array]},conditionalClass:{type:String},shouldAutoFocus:{type:Boolean},isLastChild:{type:Boolean},placeholder:{type:String},isDisabled:{type:Boolean}},emits:["on-change","on-keydown","on-paste","on-focus","on-blur"],setup(e,o){let{emit:l}=o;const s=g(e.value||""),t=g(null),r=()=>(s.value=s.value.toString(),s.value.length>1&&(s.value=s.value.slice(0,1)),l("on-change",s.value)),v=a=>a>=65&&a<=90,b=a=>a>=48&&a<=57||a>=96&&a<=105,u=a=>{e.isDisabled&&a.preventDefault();const h=a||window.event,y=h.which?h.which:h.keyCode;b(y)||e.inputType==="letter-numeric"&&v(y)||[8,9,13,37,39,46,86].includes(y)?l("on-keydown",a):h.preventDefault()},f=a=>l("on-paste",a),p=()=>(t.value.select(),l("on-focus")),w=()=>l("on-blur");return P(()=>e.value,(a,h)=>{a!==h&&(s.value=a)}),P(()=>e.focus,(a,h)=>{h!==a&&t.value&&e.focus&&(t.value.focus(),t.value.select())}),K(()=>{t.value&&e.focus&&e.shouldAutoFocus&&(t.value.focus(),t.value.select())}),{handleOnChange:r,handleOnKeyDown:u,handleOnPaste:f,handleOnFocus:p,handleOnBlur:w,input:t,model:s,inputTypeValue:e.inputType==="letter-numeric"?"text":e.inputType}}});const me={style:{display:"flex","align-items":"center"}},fe=["type","inputmode","placeholder","disabled"],ve={key:0},he=["innerHTML"];function ye(e,o,l,s,t,r){return c(),O("div",me,[W(d("input",{"data-test":"single-input",type:e.inputTypeValue,inputmode:e.inputmode,placeholder:e.placeholder,disabled:e.isDisabled,ref:"input",min:"0",max:"9",maxlength:"1",pattern:"[0-9]","onUpdate:modelValue":o[0]||(o[0]=v=>e.model=v),class:J([e.inputClasses,e.conditionalClass,{"is-complete":e.model}]),onInput:o[1]||(o[1]=function(){return e.handleOnChange&&e.handleOnChange(...arguments)}),onKeydown:o[2]||(o[2]=function(){return e.handleOnKeyDown&&e.handleOnKeyDown(...arguments)}),onPaste:o[3]||(o[3]=function(){return e.handleOnPaste&&e.handleOnPaste(...arguments)}),onFocus:o[4]||(o[4]=function(){return e.handleOnFocus&&e.handleOnFocus(...arguments)}),onBlur:o[5]||(o[5]=function(){return e.handleOnBlur&&e.handleOnBlur(...arguments)})},null,42,fe),[[G,e.model]]),!e.isLastChild&&e.separator?(c(),O("span",ve,[d("span",{innerHTML:e.separator},null,8,he)])):A("",!0)])}V.render=ye;const ge=8,Oe=37,_e=39,we=46;var z=T({name:"Vue3OtpInput",components:{SingleOtpInput:V},props:{value:{type:String,default:"",required:!0},numInputs:{default:4},separator:{type:String,default:"**"},inputClasses:{type:[String,Array]},conditionalClass:{type:Array,default:[]},inputType:{type:String,validator:e=>["number","tel","letter-numeric","password"].includes(e)},inputmode:{type:String,validator:e=>["numeric","text","tel","none"].includes(e),default:"numeric"},shouldAutoFocus:{type:Boolean,default:!1},placeholder:{type:Array,default:[]},isDisabled:{type:Boolean,default:!1},shouldFocusOrder:{type:Boolean,default:!1}},setup(e,o){let{emit:l}=o;const s=g(0),t=g([]),r=g([]);P(()=>e.value,n=>{const m=B(n).split("");t.value=m},{immediate:!0});const v=n=>{s.value=n},b=()=>{s.value=-1},u=()=>t.value.join("").length===e.numInputs?(l("update:value",t.value.join("")),l("on-complete",t.value.join(""))):"Wait until the user enters the required number of characters",f=n=>{s.value=Math.max(Math.min(e.numInputs-1,n),0)},p=()=>{f(s.value+1)},w=()=>{f(s.value-1)},a=n=>{r.value=Object.assign([],t.value),t.value[s.value]=n,r.value.join("")!==t.value.join("")&&(l("update:value",t.value.join("")),l("on-change",t.value.join("")),u())},h=n=>{n.preventDefault();const m=n.clipboardData.getData("text/plain").slice(0,e.numInputs-s.value).split("");if(e.inputType==="number"&&!m.join("").match(/^\d+$/)||e.inputType==="letter-numeric"&&!m.join("").match(/^\w+$/))return"Invalid pasted data";const $=t.value.slice(0,s.value).concat(m);return $.slice(0,e.numInputs).forEach(function(U,q){t.value[q]=U}),f($.slice(0,e.numInputs).length),u()},y=n=>{a(n),p()},i=()=>{t.value.length>0&&(l("update:value",""),l("on-change","")),t.value=[],s.value=0},C=n=>{const m=n.split("");m.length===e.numInputs&&(t.value=m,l("update:value",t.value.join("")),l("on-complete",t.value.join("")))},k=(n,m)=>{switch(n.keyCode){case ge:n.preventDefault(),a(""),w();break;case we:n.preventDefault(),a("");break;case Oe:n.preventDefault(),w();break;case _e:n.preventDefault(),p();break;default:S(m);break}},S=n=>{e.shouldFocusOrder&&setTimeout(()=>{const m=t.value.join("").length;n-m>=0&&(s.value=m,t.value[n]="")},100)};return{activeInput:s,otp:t,oldOtp:r,clearInput:i,handleOnPaste:h,handleOnKeyDown:k,handleOnBlur:b,changeCodeAtFocus:a,focusInput:f,focusNextInput:p,focusPrevInput:w,handleOnFocus:v,checkFilledAllInputs:u,handleOnChange:y,fillInput:C}}});const be={style:{display:"flex"},class:"otp-input-container"},Ce={key:0,autocomplete:"off",name:"hidden",type:"text",style:{display:"none"}};function Ie(e,o,l,s,t,r){const v=Q("SingleOtpInput");return c(),O("div",be,[e.inputType==="password"?(c(),O("input",Ce)):A("",!0),(c(!0),O(X,null,Y(e.numInputs,(b,u)=>(c(),D(v,{key:u,focus:e.activeInput===u,value:e.otp[u],separator:e.separator,"input-type":e.inputType,inputmode:e.inputmode,"input-classes":e.inputClasses,conditionalClass:e.conditionalClass[u],"is-last-child":u===e.numInputs-1,"should-auto-focus":e.shouldAutoFocus,placeholder:e.placeholder[u],"is-disabled":e.isDisabled,onOnChange:e.handleOnChange,onOnKeydown:f=>e.handleOnKeyDown(f,u),onOnPaste:e.handleOnPaste,onOnFocus:f=>e.handleOnFocus(u),onOnBlur:e.handleOnBlur},null,8,["focus","value","separator","input-type","inputmode","input-classes","conditionalClass","is-last-child","should-auto-focus","placeholder","is-disabled","onOnChange","onOnKeydown","onOnPaste","onOnFocus","onOnBlur"]))),128))])}z.render=Ie;var ke=(()=>{const e=z;return e.install=o=>{o.component("Vue3OtpInput",e)},e})();function Se(e="00:00:30",o="HH:mm:ss"){let l,s=j(e,"HH:mm:ss");const t=j("00:00:00","HH:mm:ss"),r=g("");let v,b,u,f;function p(){s>t?(s.subtract("1","second"),r.value=s.format(o)):(clearInterval(l),v&&v())}function w(){l&&a(),l=setInterval(p,1e3),u&&u()}function a(){clearInterval(l),b&&b()}function h(n){v=n}function y(n="00:00:30"){s=j(n,"HH:mm:ss"),r.value=s.format(o),a(),w()}function i(){s=j(e,"HH:mm:ss"),r.value=s.format(o),a(),w(),f&&f()}function C(n){b=n}function k(n){u=n}function S(n){f=n}return K(()=>{r.value=s.format(o)}),{time:r,stop:a,start:w,onFinish:h,reset:i,setTime:y,onRestart:S,onStart:k,onStop:C}}const $e=async e=>await Z.post("/login-user",e),Be={class:"w-full flex flex-col py3 px-5 shadow-xl rounded-lg",dir:"ltr"},De={key:1,class:"h-[90px]"},Te={key:2},Fe={class:"flex items-center my-[23px] justify-center"},je={class:"text-gray-400 mt-1"},Ae={class:"mb-2 w-full mt-2"},He={key:0,class:"flex w-full justify-center"},Pe={class:"text-primary mx-1"},Ee={key:1},Le={key:1},N=T({__name:"Login",setup(e){const{time:o,onFinish:l,reset:s}=Se("00:02:00","mm:ss"),t=g(!1),r=g(!1),v=g(),b=g(null),u=x(),f=L(["ورود با پیامک","ورود با کلمه عبور"]);g(f[0]);const p=L({email:"",password:""});l(()=>{t.value=!0});async function w(){s()}const a=g(!1);function h(){var y;(y=v.value)==null||y.validateFields().then(async()=>{var i,C,k,S;try{if(F.value=!0,!a.value){const n=await $e(p);if(console.log("user ===>",n),await te.auth.setSession(n.session),await u.getMyInfo(),!((i=u.userBorrowerInfo)!=null&&i.first_login)){const{addNotification:m}=se((C=u.userInfo)==null?void 0:C.id);m("Login User",{},`User ${(k=u.userBorrowerInfo)==null?void 0:k.owner_name_formatted} logged in for first time!`),await ae.fetch("borrowers","update",{field:"id",value:(S=u.userBorrowerInfo)==null?void 0:S.id,data:{first_login:!0}})}await oe.push({name:"home"})}}catch(n){console.log(n)}finally{F.value=!1}})}return(y,i)=>{const C=R,k=re,S=R,n=le,m=ue,E=de;return c(),O("div",Be,[i[6]||(i[6]=d("div",{class:"font-bold text-center text-xl"},"Login",-1)),_(E,{ref_key:"formRef",ref:v,model:p,name:"basic",onFinish:h,class:"!mt-5"},{default:I(()=>[r.value?A("",!0):(c(),D(C,{key:0,label:"Email",name:"email"},{default:I(()=>[_(ie,{value:p.email,"onUpdate:value":i[0]||(i[0]=$=>p.email=$),size:"large","place-holder":"Email",type:"email"},null,8,["value"])]),_:1})),_(M,{name:"fade",mode:"out-in"},{default:I(()=>[a.value?r.value?(c(),O("div",Te,[_(S,{class:"error-token",rules:[{required:!0,message:"کد ارسال شده را وارد نمایید"},{min:4,max:4,message:"کد ارسال شده را وارد نمایید"}],name:"token"},{default:I(()=>[_(B(ke),{style:{direction:"ltr"},class:"mt-5 justify-center",ref_key:"refOtpInput",ref:b,autocomplete:"one-time-code","input-classes":"otp-input",separator:"",value:"","num-inputs":4,"should-auto-focus":!0,"is-input-num":!0,onOnChange:y.handleOnChange,onOnComplete:y.handleOnComplete},null,8,["onOnChange","onOnComplete"])]),_:1}),d("div",Fe,[d("span",je,H(p==null?void 0:p.mobile),1),d("div",{class:"flex items-center text-gray-700 mr-2",onClick:i[2]||(i[2]=$=>r.value=!1)},[i[3]||(i[3]=d("span",{class:"ml-1"},"ویرایش شماره",-1)),_(ee,{icon:"vuesax-linear:edit",size:"20"})])]),d("div",Ae,[_(n,{type:"dashed",disabled:!t.value,class:"w-full",onClick:w},{default:I(()=>[t.value?(c(),O("div",Ee," ارسال مجدد کد تایید ")):(c(),O("div",He,[i[4]||(i[4]=d("span",null,"ارسال مجدد کد در ",-1)),d("span",Pe,H(B(o)),1),i[5]||(i[5]=d("span",null," دیگر ",-1))]))]),_:1},8,["disabled"])])])):(c(),O("div",De)):(c(),D(C,{key:0,label:"Password",name:"password"},{default:I(()=>[_(k,{value:p.password,"onUpdate:value":i[1]||(i[1]=$=>p.password=$),size:"large","place-holder":"Password"},null,8,["value"])]),_:1}))]),_:1}),_(C,null,{default:I(()=>[_(ne,{class:"w-full py-2 mt-2",disabled:B(F),type:"primary","html-type":"submit"},{default:I(()=>[d("div",null,[B(F)?(c(),D(m,{key:0,size:"small"})):(c(),O("div",Le,H(a.value?r.value?"Submit":"Send Code":"Submit"),1))])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])])}}}),Re={class:"grid grid-cols-5 items-center w-screen h-screen"},Ke={class:"col-span-3 flex justify-center"},Me=["src"],Ve={class:"w-full col-span-2 flex justify-center"},ze={class:"bg-white rounded-lg z-1000 p-6 w-[25rem]"},Ne=T({__name:"full",setup(e){return(o,l)=>(c(),O("div",null,[d("div",Re,[d("div",Ke,[d("img",{src:B(pe),alt:"",class:"w-3/4"},null,8,Me)]),d("div",Ve,[d("div",ze,[_(N)])])])]))}}),Ue={class:"flex items-center h-[92vh] justify-center"},qe={class:"z-1000 w-full p-10"},We=T({__name:"mobile",setup(e){const o=g(!1);function l(s){o.value=s}return(s,t)=>(c(),O("div",Ue,[d("div",qe,[_(M,{name:"fade",mode:"out-in"},{default:I(()=>[o.value?A("",!0):(c(),D(N,{key:0,onRegister:l}))]),_:1})])]))}}),Ge=ce(),en=Ge.isMobile?We:Ne;export{en as default};
