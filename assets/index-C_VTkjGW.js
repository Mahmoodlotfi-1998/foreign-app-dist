import{d as T,r as g,w as P,o as M,a as r,c as _,b as G,v as J,e as d,n as Q,f as A,u as B,g as X,F as Y,h as Z,i as D,j as x,k as L,l as O,m as I,T as V,t as H,B as ee,_ as ne,p as F,s as R,q as te,x as se,y as ae,S as oe}from"./index-C6SLAYHp.js";import{_ as le,a as ue}from"./BasicInput.vue_vue_type_style_index_0_lang-DHfynytP.js";import{h as j}from"./moment-Cl4UOzQZ.js";import{_ as K,F as ie}from"./index-CBnZ3Swj.js";import{u as re}from"./responsiveStore-Ysp6_bE0.js";import"./index-CqW328BA.js";const de="/assets/login-D7vvtwuK.svg";var N=T({name:"SingleOtpInput",props:{inputType:{type:String,validator:e=>["number","tel","letter-numeric","password"].includes(e),default:"tel"},inputmode:{type:String,default:"numeric"},value:{type:[String,Number]},separator:{type:String},focus:{type:Boolean},inputClasses:{type:[String,Array]},conditionalClass:{type:String},shouldAutoFocus:{type:Boolean},isLastChild:{type:Boolean},placeholder:{type:String},isDisabled:{type:Boolean}},emits:["on-change","on-keydown","on-paste","on-focus","on-blur"],setup(e,o){let{emit:l}=o;const s=g(e.value||""),t=g(null),i=()=>(s.value=s.value.toString(),s.value.length>1&&(s.value=s.value.slice(0,1)),l("on-change",s.value)),f=a=>a>=65&&a<=90,b=a=>a>=48&&a<=57||a>=96&&a<=105,u=a=>{e.isDisabled&&a.preventDefault();const v=a||window.event,h=v.which?v.which:v.keyCode;b(h)||e.inputType==="letter-numeric"&&f(h)||[8,9,13,37,39,46,86].includes(h)?l("on-keydown",a):v.preventDefault()},p=a=>l("on-paste",a),c=()=>(t.value.select(),l("on-focus")),w=()=>l("on-blur");return P(()=>e.value,(a,v)=>{a!==v&&(s.value=a)}),P(()=>e.focus,(a,v)=>{v!==a&&t.value&&e.focus&&(t.value.focus(),t.value.select())}),M(()=>{t.value&&e.focus&&e.shouldAutoFocus&&(t.value.focus(),t.value.select())}),{handleOnChange:i,handleOnKeyDown:u,handleOnPaste:p,handleOnFocus:c,handleOnBlur:w,input:t,model:s,inputTypeValue:e.inputType==="letter-numeric"?"text":e.inputType}}});const ce={style:{display:"flex","align-items":"center"}},pe=["type","inputmode","placeholder","disabled"],me={key:0},fe=["innerHTML"];function ve(e,o,l,s,t,i){return r(),_("div",ce,[G(d("input",{"data-test":"single-input",type:e.inputTypeValue,inputmode:e.inputmode,placeholder:e.placeholder,disabled:e.isDisabled,ref:"input",min:"0",max:"9",maxlength:"1",pattern:"[0-9]","onUpdate:modelValue":o[0]||(o[0]=f=>e.model=f),class:Q([e.inputClasses,e.conditionalClass,{"is-complete":e.model}]),onInput:o[1]||(o[1]=function(){return e.handleOnChange&&e.handleOnChange(...arguments)}),onKeydown:o[2]||(o[2]=function(){return e.handleOnKeyDown&&e.handleOnKeyDown(...arguments)}),onPaste:o[3]||(o[3]=function(){return e.handleOnPaste&&e.handleOnPaste(...arguments)}),onFocus:o[4]||(o[4]=function(){return e.handleOnFocus&&e.handleOnFocus(...arguments)}),onBlur:o[5]||(o[5]=function(){return e.handleOnBlur&&e.handleOnBlur(...arguments)})},null,42,pe),[[J,e.model]]),!e.isLastChild&&e.separator?(r(),_("span",me,[d("span",{innerHTML:e.separator},null,8,fe)])):A("",!0)])}N.render=ve;const he=8,ye=37,ge=39,_e=46;var z=T({name:"Vue3OtpInput",components:{SingleOtpInput:N},props:{value:{type:String,default:"",required:!0},numInputs:{default:4},separator:{type:String,default:"**"},inputClasses:{type:[String,Array]},conditionalClass:{type:Array,default:[]},inputType:{type:String,validator:e=>["number","tel","letter-numeric","password"].includes(e)},inputmode:{type:String,validator:e=>["numeric","text","tel","none"].includes(e),default:"numeric"},shouldAutoFocus:{type:Boolean,default:!1},placeholder:{type:Array,default:[]},isDisabled:{type:Boolean,default:!1},shouldFocusOrder:{type:Boolean,default:!1}},setup(e,o){let{emit:l}=o;const s=g(0),t=g([]),i=g([]);P(()=>e.value,n=>{const m=B(n).split("");t.value=m},{immediate:!0});const f=n=>{s.value=n},b=()=>{s.value=-1},u=()=>t.value.join("").length===e.numInputs?(l("update:value",t.value.join("")),l("on-complete",t.value.join(""))):"Wait until the user enters the required number of characters",p=n=>{s.value=Math.max(Math.min(e.numInputs-1,n),0)},c=()=>{p(s.value+1)},w=()=>{p(s.value-1)},a=n=>{i.value=Object.assign([],t.value),t.value[s.value]=n,i.value.join("")!==t.value.join("")&&(l("update:value",t.value.join("")),l("on-change",t.value.join("")),u())},v=n=>{n.preventDefault();const m=n.clipboardData.getData("text/plain").slice(0,e.numInputs-s.value).split("");if(e.inputType==="number"&&!m.join("").match(/^\d+$/)||e.inputType==="letter-numeric"&&!m.join("").match(/^\w+$/))return"Invalid pasted data";const $=t.value.slice(0,s.value).concat(m);return $.slice(0,e.numInputs).forEach(function(q,W){t.value[W]=q}),p($.slice(0,e.numInputs).length),u()},h=n=>{a(n),c()},y=()=>{t.value.length>0&&(l("update:value",""),l("on-change","")),t.value=[],s.value=0},C=n=>{const m=n.split("");m.length===e.numInputs&&(t.value=m,l("update:value",t.value.join("")),l("on-complete",t.value.join("")))},k=(n,m)=>{switch(n.keyCode){case he:n.preventDefault(),a(""),w();break;case _e:n.preventDefault(),a("");break;case ye:n.preventDefault(),w();break;case ge:n.preventDefault(),c();break;default:S(m);break}},S=n=>{e.shouldFocusOrder&&setTimeout(()=>{const m=t.value.join("").length;n-m>=0&&(s.value=m,t.value[n]="")},100)};return{activeInput:s,otp:t,oldOtp:i,clearInput:y,handleOnPaste:v,handleOnKeyDown:k,handleOnBlur:b,changeCodeAtFocus:a,focusInput:p,focusNextInput:c,focusPrevInput:w,handleOnFocus:f,checkFilledAllInputs:u,handleOnChange:h,fillInput:C}}});const Oe={style:{display:"flex"},class:"otp-input-container"},we={key:0,autocomplete:"off",name:"hidden",type:"text",style:{display:"none"}};function be(e,o,l,s,t,i){const f=X("SingleOtpInput");return r(),_("div",Oe,[e.inputType==="password"?(r(),_("input",we)):A("",!0),(r(!0),_(Y,null,Z(e.numInputs,(b,u)=>(r(),D(f,{key:u,focus:e.activeInput===u,value:e.otp[u],separator:e.separator,"input-type":e.inputType,inputmode:e.inputmode,"input-classes":e.inputClasses,conditionalClass:e.conditionalClass[u],"is-last-child":u===e.numInputs-1,"should-auto-focus":e.shouldAutoFocus,placeholder:e.placeholder[u],"is-disabled":e.isDisabled,onOnChange:e.handleOnChange,onOnKeydown:p=>e.handleOnKeyDown(p,u),onOnPaste:e.handleOnPaste,onOnFocus:p=>e.handleOnFocus(u),onOnBlur:e.handleOnBlur},null,8,["focus","value","separator","input-type","inputmode","input-classes","conditionalClass","is-last-child","should-auto-focus","placeholder","is-disabled","onOnChange","onOnKeydown","onOnPaste","onOnFocus","onOnBlur"]))),128))])}z.render=be;var Ce=(()=>{const e=z;return e.install=o=>{o.component("Vue3OtpInput",e)},e})();function Ie(e="00:00:30",o="HH:mm:ss"){let l,s=j(e,"HH:mm:ss");const t=j("00:00:00","HH:mm:ss"),i=g("");let f,b,u,p;function c(){s>t?(s.subtract("1","second"),i.value=s.format(o)):(clearInterval(l),f&&f())}function w(){l&&a(),l=setInterval(c,1e3),u&&u()}function a(){clearInterval(l),b&&b()}function v(n){f=n}function h(n="00:00:30"){s=j(n,"HH:mm:ss"),i.value=s.format(o),a(),w()}function y(){s=j(e,"HH:mm:ss"),i.value=s.format(o),a(),w(),p&&p()}function C(n){b=n}function k(n){u=n}function S(n){p=n}return M(()=>{i.value=s.format(o)}),{time:i,stop:a,start:w,onFinish:v,reset:y,setTime:h,onRestart:S,onStart:k,onStop:C}}const ke={class:"w-full flex flex-col py3 px-5 shadow-xl rounded-lg",dir:"ltr"},Se=d("div",{class:"font-bold text-center text-xl"},"Login",-1),$e={key:1,class:"h-[90px]"},Be={key:2},De={class:"flex items-center my-[23px] justify-center"},Te={class:"text-gray-400 mt-1"},Fe=d("span",{class:"ml-1"},"ویرایش شماره",-1),je={class:"mb-2 w-full mt-2"},Ae={key:0,class:"flex w-full justify-center"},He=d("span",null,"ارسال مجدد کد در ",-1),Pe={class:"text-primary mx-1"},Ee=d("span",null," دیگر ",-1),Le={key:1},Re={key:1},U=T({__name:"Login",setup(e){const{time:o,onFinish:l,reset:s}=Ie("00:02:00","mm:ss"),t=g(!1),i=g(!1),f=g(),b=g(null),u=x(),p=L(["ورود با پیامک","ورود با کلمه عبور"]);g(p[0]);const c=L({email:"",password:""});l(()=>{t.value=!0});async function w(){s()}const a=g(!1);function v(){var h;(h=f.value)==null||h.validateFields().then(async()=>{var y,C,k,S;try{if(F.value=!0,!a.value){if(await R.login(c),await u.getMyInfo(),!((y=u.userBorrowerInfo)!=null&&y.first_login)){const{addNotification:n}=te((C=u.userInfo)==null?void 0:C.id);n("Login User",{},`User ${(k=u.userBorrowerInfo)==null?void 0:k.owner_name_formatted} logged in for first time!`),await R.fetch("borrowers","update",{field:"id",value:(S=u.userBorrowerInfo)==null?void 0:S.id,data:{first_login:!0}})}await se.push({name:"home"})}}catch(n){console.log(n)}finally{F.value=!1}})}return(h,y)=>{const C=K,k=ue,S=K,n=ae,m=oe,E=ie;return r(),_("div",ke,[Se,O(E,{ref_key:"formRef",ref:f,model:c,name:"basic",onFinish:v,class:"!mt-5"},{default:I(()=>[i.value?A("",!0):(r(),D(C,{key:0,label:"Email",name:"email"},{default:I(()=>[O(le,{value:c.email,"onUpdate:value":y[0]||(y[0]=$=>c.email=$),size:"large","place-holder":"Email",type:"email"},null,8,["value"])]),_:1})),O(V,{name:"fade",mode:"out-in"},{default:I(()=>[a.value?i.value?(r(),_("div",Be,[O(S,{class:"error-token",rules:[{required:!0,message:"کد ارسال شده را وارد نمایید"},{min:4,max:4,message:"کد ارسال شده را وارد نمایید"}],name:"token"},{default:I(()=>[O(B(Ce),{style:{direction:"ltr"},class:"mt-5 justify-center",ref_key:"refOtpInput",ref:b,autocomplete:"one-time-code","input-classes":"otp-input",separator:"",value:"","num-inputs":4,"should-auto-focus":!0,"is-input-num":!0,onOnChange:h.handleOnChange,onOnComplete:h.handleOnComplete},null,8,["onOnChange","onOnComplete"])]),_:1}),d("div",De,[d("span",Te,H(c==null?void 0:c.mobile),1),d("div",{class:"flex items-center text-gray-700 mr-2",onClick:y[2]||(y[2]=$=>i.value=!1)},[Fe,O(ee,{icon:"vuesax-linear:edit",size:"20"})])]),d("div",je,[O(n,{type:"dashed",disabled:!t.value,class:"w-full",onClick:w},{default:I(()=>[t.value?(r(),_("div",Le," ارسال مجدد کد تایید ")):(r(),_("div",Ae,[He,d("span",Pe,H(B(o)),1),Ee]))]),_:1},8,["disabled"])])])):(r(),_("div",$e)):(r(),D(C,{key:0,label:"Password",name:"password"},{default:I(()=>[O(k,{value:c.password,"onUpdate:value":y[1]||(y[1]=$=>c.password=$),size:"large","place-holder":"Password"},null,8,["value"])]),_:1}))]),_:1}),O(C,null,{default:I(()=>[O(ne,{class:"w-full py-2 mt-2",disabled:B(F),type:"primary","html-type":"submit"},{default:I(()=>[d("div",null,[B(F)?(r(),D(m,{key:0,size:"small"})):(r(),_("div",Re,H(a.value?i.value?"Submit":"Send Code":"Submit"),1))])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model"])])}}}),Ke={class:"grid grid-cols-5 items-center w-screen h-screen"},Me={class:"col-span-3 flex justify-center"},Ve=["src"],Ne={class:"w-full col-span-2 flex justify-center"},ze={class:"bg-white rounded-lg z-1000 p-6 w-[25rem]"},Ue=T({__name:"full",setup(e){return(o,l)=>(r(),_("div",null,[d("div",Ke,[d("div",Me,[d("img",{src:B(de),alt:"",class:"w-3/4"},null,8,Ve)]),d("div",Ne,[d("div",ze,[O(U)])])])]))}}),qe={class:"flex items-center h-[92vh] justify-center"},We={class:"z-1000 w-full p-10"},Ge=T({__name:"mobile",setup(e){const o=g(!1);function l(s){o.value=s}return(s,t)=>(r(),_("div",qe,[d("div",We,[O(V,{name:"fade",mode:"out-in"},{default:I(()=>[o.value?A("",!0):(r(),D(U,{key:0,onRegister:l}))]),_:1})])]))}}),Je=re(),nn=Je.isMobile?Ge:Ue;export{nn as default};
